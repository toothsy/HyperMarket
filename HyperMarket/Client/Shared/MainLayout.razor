@inherits LayoutComponentBase
@inject ILocalStorageService LocalStorage
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager NavigationManager


<MudThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />


<MudLayout>
   @* <MudGrid Class="justify-center d-flex align-center mud-width-full py-8">*@
    <div class="flex-container">
        <MudAppBar style="background-color : #f35555;" Fixed="false" Dense="true">
            <div><a href="/"> <MudImage Src="images/LOGO.png" Width="48" Height="48" /></a></div>
            <div>
               
                <MudSelect T="string" Label="Location" AnchorOrigin="Origin.BottomCenter">
                    @foreach (var item in AllLocations)
                    {
                        <MudSelectItem Value=@item />
                    }

                 </MudSelect>
            </div>

            <AuthorizeView Roles="User">
                <Authorized>
                    <div class="space1">
                        <span>Hi, @context.User.Identity.Name </span>
                    </div>
                    <div class="space2">
                        <MudLink href="listBusiness"><div class="appcolor">List Your Business</div></MudLink>
                    </div>

                    <div>
                        <div class="first">
                            <MudSelect T="string" Label="My Account"  AnchorOrigin="Origin.BottomCenter">
                                <a href="/MyProfile"><MudSelectItem Value="@("My Profile")" /></a>
                               @* <a href="/MyOrderCustomer"><MudSelectItem Value="@("My Orders")" /></a>*@
                                <a href="/MyBusiness"><MudSelectItem Value="@("My Business")" /></a>
                                <a href="/AddProduct"><MudSelectItem Value="@("Add Product")" /></a>
                                <a href="/MyProduct"><MudSelectItem Value="@("My Products")" /></a>

                            </MudSelect>
                        </div>
                    </div>
                    <div class="space3"> <MudLink @onclick="Signout"><div class="appcolor">Sign Out</div></MudLink></div>

                </Authorized>
                <NotAuthorized>

                    <div class="space4"><MudLink href="signin"><div class="appcolor">Sign In</div></MudLink></div>
                    <div class="space5"><MudLink href="signup"><div class="appcolor">Sign Up</div></MudLink></div>

                </NotAuthorized>
            </AuthorizeView>

            @* <AuthorizeView Roles="Business">
                <Authorized>
                <div class="space1">
                <span>Hi, @context.User.Identity.Name </span>
                </div>

                <div>
                <div class="first">
                <MudSelect T="string" Label="My Account" AnchorOrigin="Origin.BottomCenter">
                <a href="/MyBusiness"><MudSelectItem Value="@("My Business")" /></a>
                <a href="/MyProduct"><MudSelectItem Value="@("My Products")" /></a>

                </MudSelect>
                </div>
                </div>
                <div class="space3"> <MudLink @onclick="Signout"><div class = "appcolor">Sign Out</div></MudLink></div>

                </Authorized>

                <NotAuthorized>
                You do not have access to view this page
                </NotAuthorized>
                </AuthorizeView>*@

            @*<MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Inherit" />*@
        </MudAppBar>
    </div>
   @* </MudGrid>*@

    <MudMainContent style="background-color: #cbf0f5d4;">
        @Body
    </MudMainContent>
    <div class="container">
        <ul class="flex-row">
            <MudAppBar Color="Color.Dark" Fixed="true" Dense="true" Bottom="true">
                <MudLink Href="/About" Underline="Underline.Always"><a class="link1" href="/about">About</a></MudLink>
                <MudLink Href="/Blog" Underline="Underline.Always"><a class="link1" href="/blog">Blog</a></MudLink>
                <MudLink Href="/SocialMedia" Style="color: white;" Underline="Underline.Always"><a class="link1" href="/SocialMedia">Social Media</a></MudLink>
                <MudLink Href="/FAQ" Style="color: white;" Underline="Underline.Always"><a class="link1" href="/FAQ">FAQ's</a></MudLink>
                <MudLink Href="/ContactUs" Style="color: white;" Underline="Underline.Always"><a class="link1" href="/ContactUs">Contact Us</a></MudLink>
            </MudAppBar>
        </ul>
    </div>
</MudLayout>


@code
{
    public List<String> AllLocations = new List<String>();

    protected override async Task OnInitializedAsync()
    {
        AllLocations = await locationService.GetAllLocation();
    }

    private async void Signout()
    {
        await LocalStorage.RemoveItemAsync("authToken");
        await AuthStateProvider.GetAuthenticationStateAsync();
        NavigationManager.NavigateTo("/");
    }
}